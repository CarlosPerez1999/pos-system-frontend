<section class="w-full h-full px-5 pb-4 flex flex-col gap-6 lg:overflow-hidden">
    <h2 class="w-full text-2xl sm:text-3xl font-bold">Dashboard</h2>

    <!-- KPI Cards Grid -->
    @if (salesService.summary()) {
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
        <app-kpi-card title="Total Sales" [value]="salesService.summary()!.totalSales" icon="mdi:cart-outline"
            format="number" />
        <app-kpi-card title="Total Revenue" [value]="salesService.summary()!.totalRevenue" icon="mdi:cash-multiple"
            format="currency" />
        <app-kpi-card title="Today's Revenue" [value]="salesService.summary()!.dayRevenue" icon="mdi:calendar-today"
            format="currency" />
        <app-kpi-card title="Average Ticket" [value]="salesService.summary()!.averageTicket"
            icon="mdi:receipt-text-outline" format="currency" />
    </div>
    }

    <div class="w-full flex flex-col lg:flex-row flex-1 gap-x-6 gap-y-4 lg:min-h-0">

        <div class="w-full bg-surface rounded-lg p-6 shadow-md flex flex-col overflow-hidden">
            <h3 class="text-xl font-bold mb-4">Top Products</h3>
            <app-bar-chart class="w-full flex-1 min-h-0" [data]="barChartData()" title="Top Products" />
        </div>


        <div class="w-full bg-surface rounded-lg p-6 shadow-md flex flex-col overflow-auto">
            <h3 class="text-xl font-bold mb-4">Today's Sales</h3>
            @if (salesService.todaySales().length > 0) {
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="border-b border-border">
                            <th class="text-left py-3 px-4 font-semibold text-muted">Sale ID</th>
                            <th class="text-left py-3 px-4 font-semibold text-muted">Time</th>
                            <th class="text-right py-3 px-4 font-semibold text-muted">Items</th>
                            <th class="text-right py-3 px-4 font-semibold text-muted">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        @for (sale of salesService.todaySales(); track sale.id) {
                        <tr class="border-b border-border/50 hover:bg-background transition-colors">
                            <td class="py-3 px-4">#{{ sale.id }}</td>
                            <td class="py-3 px-4">{{ sale.date | date:'shortTime' }}</td>
                            <td class="text-right py-3 px-4">{{ sale.items.length }}</td>
                            <td class="text-right py-3 px-4 font-semibold">{{ sale.total |
                                currency:'USD':'symbol':'1.2-2' }}
                            </td>
                        </tr>
                        }
                    </tbody>
                </table>
            </div>
            } @else {
            <p class="text-muted text-center py-8">No sales recorded today</p>
            }
        </div>
    </div>
</section>